<!--
  -  Decoders for Jenkins
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015-2019, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<decoder name="jenkins">
    <prematch>^\w+ \d+, \d+ \d+:\d+:\d+ \wM hudson.\.+|^\w+ \d+, \d+ \d+:\d+:\d+ \wM \.*jenkins\.*</prematch>
</decoder>

<!--
Feb 18, 2017 8:51:56 AM hudson.model.UpdateCenter$DownloadJob run INFO: Installation successful: PAM Authentication plugin
-->
<decoder name="jenkins-info-installation">
    <parent>jenkins</parent>
    <prematch>^\w+ \d+, \d+ \d+:\d+:\d+ \wM hudson.\.+ Installation successful: </prematch>
    <regex>^\w+ \d+, \d+ \d+:\d+:\d+ \wM (hudson.\S+) (\S+) (\w+): Installation successful: (\.+)</regex>
    <order>jenkins.component,jenkins.action,jenkins.severity,jenkins.plugin</order>
</decoder>

<!--
Feb 18, 2017 8:53:02 AM hudson.model.UpdateCenter$DownloadJob run INFO: Starting the installation of PAM Authentication plugin on behalf of admin
-->
<decoder name="jenkins-info-starting">
    <parent>jenkins</parent>
    <prematch>^\w+ \d+, \d+ \d+:\d+:\d+ \wM hudson.\.+ Starting the installation </prematch>
    <regex>^\w+ \d+, \d+ \d+:\d+:\d+ \wM (hudson.\S+) (\S+) (\w+): Starting the installation of (\.+) on behalf of (\S+)</regex>
    <order>jenkins.component,jenkins.action,jenkins.severity,jenkins.plugin,srcuser</order>
</decoder>

<!--
Feb 18, 2017 8:48:15 AM org.jenkinsci.main.modules.sshd.SSHD start INFO: Started SSHD at port 35627
-->
<decoder name="jenkins-info-sshd">
    <parent>jenkins</parent>
    <prematch>^\w+ \d+, \d+ \d+:\d+:\d+ \wM org.jenkinsci.main.modules.sshd.SSHD start \S+: Started SSHD at port \d+</prematch>
    <regex>^\w+ \d+, \d+ \d+:\d+:\d+ \wM (org.jenkinsci.main.modules.sshd.SSHD) (start) (\S+): (Started SSHD) at port (\d+)</regex>
    <order>jenkins.component,jenkins.action,jenkins.severity,msg,port</order>
</decoder>

<decoder name="jenkins-generic">
    <parent>jenkins</parent>
    <regex>^\w+ \d+, \d+ \d+:\d+:\d+ \wM (hudson.\S+) (\S+) (\w+): (\.+)|^\w+ \d+, \d+ \d+:\d+:\d+ \wM (\.*jenkins\.*) (\S+) (\w+): (\.+)</regex>
    <order>jenkins.component,jenkins.action,jenkins.severity,jenkins.plugin</order>
</decoder>